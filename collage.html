<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Collage | Amandine Mangon</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      width: 100%;
      height: 100%;
      font: 400 15px/1.3 "Helvetica Neue", Helvetica, Arial, sans-serif;
      background: #000;
      color: #fff;
      overflow-x: hidden;
      text-transform: uppercase;
    }

    /* Top bar */
    .bar{
      position: sticky; top: 0; z-index: 1000;
      display: flex; align-items: center; gap: 1rem;
      padding: 12px 14px;
      background: #000;
      border-bottom: 1px solid #1a1a1a;
    }

    /* Home in top-left */
    .home-btn {
      text-decoration: none;
      font-weight: 700;
      font-size: .8rem;
      letter-spacing: .06em;
      padding: 6px 12px;
      background: #fff;
      color: #000;
      border: none;
    }

    /* Tabs */
    nav.tabs { display: flex; gap: 16px; align-items: center; }
    nav.tabs a{
      text-decoration: none;
      color: #fff; opacity: .8;
      padding: 4px 0; position: relative;
      font-weight: 700; letter-spacing: .04em;
    }
    nav.tabs a[aria-current="page"]{ opacity: 1; }
    nav.tabs a[aria-current="page"]::after{
      content: ""; position: absolute; left: 0; right: 0; bottom: -6px;
      height: 2px; background: #fff;
    }

    main{ max-width: 1400px; margin: 0 auto; }

    /* Grid base (Girl, Postcards, Reconstruction) */
    .gallery {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      padding: 18px 10px 24px;
    }
    @media (min-width: 640px) {
      .gallery { grid-template-columns: repeat(3, 1fr); }
    }
    @media (min-width: 1024px) {
      .gallery { grid-template-columns: repeat(4, 1fr); }
    }
    .gallery img {
      width: 100%;
      height: auto;
      border: 1px solid #444;
      cursor: pointer;
      transition: transform 0.2s;
      display: block;
      background: #111;
    }
    .gallery img:hover { transform: scale(1.03); }

    /* Friends variant */
    .gallery.friends {
      grid-template-columns: repeat(2, 1fr);
      gap: 50px; padding: 60px 20px;
    }
    @media (min-width: 640px) {
      .gallery.friends { grid-template-columns: repeat(3, 1fr); }
    }
    .gallery-item { display: flex; flex-direction: column; align-items: center; cursor: pointer; }
    .gallery.friends img { width: 80%; border: 1px solid #444; }

    .caption {
      margin-top: 5px;
      font-size: 1.25rem;
      letter-spacing: .05em;
      color: #fff;
      text-align: center;
      font-weight: bold;
      text-decoration: none;
    }

    /* Lightbox (Girl/Postcards/Reconstruction) */
    .lightbox {
      display: none;
      position: fixed; inset: 0;
      z-index: 2000;
      background: rgba(0,0,0,.9);
      justify-content: center;
      align-items: center;
      touch-action: pan-y;
    }
    .lightbox img {
      max-width: 92vw;
      max-height: 92vh;
      border: 1px solid #fff;
      background: #000;
    }

    /* Friends lightbox with caption */
    .lightbox.friends {
      padding: 30px; text-align: center;
    }
    .lightbox.friends.active {
      display: flex; flex-direction: column;
    }
    .lightbox-caption {
      max-width: 400px;
      font-size: 1.25rem;
      margin-top: 20px;
      color: #fff;
      text-transform: uppercase;
      font-weight: bold;
      margin-left: auto; margin-right: auto;
    }
    .close-btn {
      position: absolute; top: 20px; right: 30px;
      font-size: 2rem; color: #fff; cursor: pointer;
    }

    /* Postcards popup */
    .popup-overlay {
      position: fixed; inset: 0;
      background: rgba(0, 0, 0, 0.9);
      z-index: 3000;
      display: none;
      justify-content: center;
      align-items: center;
    }
    .popup-box {
      background: #000; border: 1px solid white;
      padding: 40px 30px; max-width: 600px;
      color: white; text-align: center; font-size: 1rem; line-height: 1.5;
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      text-transform: uppercase;
    }

    footer {
      text-align: center;
      font-size: 0.9rem;
      color: #fff;
      margin: 0.7rem 0 1rem;
      opacity: .9;
    }
  </style>
</head>
<body>

  <header class="bar">
    <a class="home-btn" href="index.html">HOME</a>
    <nav class="tabs" role="tablist" aria-label="Gallery Sections">
      <a href="#girl"           role="tab" data-tab="girl">Girl</a>
      <a href="#postcards"      role="tab" data-tab="postcards">Postcards</a>
      <a href="#friends"        role="tab" data-tab="friends">Friends</a>
      <a href="#reconstruction" role="tab" data-tab="reconstruction">Reconstruction</a>
    </nav>
  </header>

  <main>
    <!-- Shared container that is re-rendered per tab -->
    <div id="gallery" class="gallery"></div>
  </main>

  <!-- Lightbox used for Girl/Postcards/Reconstruction -->
  <div id="lightbox" class="lightbox" aria-modal="true" role="dialog">
    <img id="lightbox-img" src="" alt="enlarged" />
  </div>

  <!-- Friends lightbox with caption -->
  <div id="friends-lightbox" class="lightbox friends" aria-modal="true" role="dialog">
    <div class="close-btn" id="friends-close">&times;</div>
    <img id="friends-img" src="" alt="Friend photo" />
    <div class="lightbox-caption" id="friends-caption"></div>
  </div>

  <!-- Postcards popup -->
  <div id="popup" class="popup-overlay">
    <div class="popup-box">
      I make postcards by collaging photos and text from old National Geographic magazines from the 80s and 90s. I like pairing words with images in unexpected ways, using irony to create new meanings out of familiar scenes. Collage is my way to experiment and tell stories, and this project is a space for me to be playful and creative.
      <br><br>Press ESC or click anywhere to continue.
    </div>
  </div>

  <footer>© 2025 Amandine Mangon</footer>

  <script>
    // Tabs → data sources or renderers
    const DATA = {
      girl:      { json: 'girl.json',           base: 'photos/' },
      postcards: { json: 'images.json',         base: 'photos/' },
      friends:   { json: null,                  base: null      }, // special renderer
      reconstruction: { json: 'reconstruction.json', base: 'reconstruction/' }
    };

    // Friends data copied from your friends.html
    const FRIENDS = [
      { name: "Santi",    src: "friends/santi.jpeg",    caption: "Santi likes to go rock climbing with his friends. He enjoys a black coffee for breakfast, and that's it. He indulges in a cigarette once in a while, and always has a shoulder to lean on." },
      { name: "Laura",    src: "friends/laura.jpeg",    caption: "Laura’s favorite color is pink and she likes to spend time outdoors. She also enjoys nicotine products." },
      { name: "Justice",  src: "friends/justice.jpeg",  caption: "Justice is known for wearing an ERD rat broach on his hat. He wears silver jewelry and likes to smoke with friends." },
      { name: "Frankie",  src: "friends/frankie.jpeg",  caption: "Frankie lives in NYC and plays many instruments including the piano. She has a lighter with her name engraved on it. She likes florals and going on walks." },
      { name: "Mateo",    src: "friends/mateo.jpeg",    caption: "Mateo used to live in Iowa and now lives in New York City. In both his personal and work life he is a photographer. He wears black broken rosary beads." },
      { name: "Juliette", src: "friends/juliette.jpeg", caption: "Juliette spends her summers in the south of France going to the beach. She loves clothes, especially dresses, and has a growing collection of perfumes." },
      { name: "Sophia",   src: "friends/sophia.jpeg",   caption: "Sophia lives in London, but is also part Danish. She has a great taste in fashion and enjoys going out for drinks with her friends. She also has horses." },
      { name: "Ava",      src: "friends/ava.jpeg",      caption: "Ava studies politics and likes the cold weather. She likes listening to music, and has a poster of John Coltrane in her room. She also enjoys hot sauce." },
      { name: "Chris",    src: "friends/chris.jpeg",    caption: "Chris is full of energy and loves being on AUX or queuing songs during group gatherings. He studies Photography and goes skiing every winter." }
    ];

    const galleryEl  = document.getElementById('gallery');
    const stdBox     = document.getElementById('lightbox');
    const stdImg     = document.getElementById('lightbox-img');

    const friendsBox = document.getElementById('friends-lightbox');
    const friendsImg = document.getElementById('friends-img');
    const friendsCap = document.getElementById('friends-caption');
    const friendsClose = document.getElementById('friends-close');

    const popup = document.getElementById('popup');

    const tabLinks = Array.from(document.querySelectorAll('nav.tabs a'));
    const cache = new Map(); // tab → [paths]

    let paths = []; // current images for std lightbox tabs
    let idx = -1;

    function currentTab() {
      const h = (location.hash || '#girl').slice(1).toLowerCase();
      return DATA[h] ? h : 'girl';
    }

    function underlineActive(tab) {
      tabLinks.forEach(a => {
        if (a.dataset.tab === tab) a.setAttribute('aria-current','page');
        else a.removeAttribute('aria-current');
      });
    }

    async function loadJSON(file) {
      const resp = await fetch(file);
      return resp.json();
    }

    // Renderers per tab
    async function renderGirl() {
      await renderStandard('girl');
    }
    async function renderPostcards() {
      // Show popup only the first time we enter this tab in this session
      if (!sessionStorage.getItem('postcardsPopupShown')) {
        popup.style.display = 'flex';
        const dismiss = () => {
          popup.style.display = 'none';
          sessionStorage.setItem('postcardsPopupShown','1');
          popup.removeEventListener('click', dismiss);
          document.removeEventListener('keydown', onEsc);
        };
        const onEsc = (e) => { if (e.key === 'Escape') dismiss(); };
        popup.addEventListener('click', dismiss);
        document.addEventListener('keydown', onEsc);
      }
      await renderStandard('postcards');
    }
    async function renderReconstruction() {
      await renderStandard('reconstruction');
    }
    async function renderFriends() {
      // Grid
      galleryEl.className = 'gallery friends';
      galleryEl.innerHTML = '';
      FRIENDS.forEach((f, i) => {
        const item = document.createElement('div');
        item.className = 'gallery-item';
        item.innerHTML = `
          <img src="${f.src}" alt="${f.name}">
          <div class="caption">${f.name}</div>
        `;
        item.onclick = () => openFriends(i);
        galleryEl.appendChild(item);
      });
      // Make sure standard lightbox is closed
      closeStd();
    }

    async function renderStandard(tab) {
      galleryEl.className = 'gallery'; // reset base grid
      // load or use cache
      if (!cache.has(tab)) {
        const { json, base } = DATA[tab];
        const list = await loadJSON(json); // ["img1.jpg", ...]
        const full = list.map(name => `${base}${name}`);
        cache.set(tab, full);
      }
      paths = cache.get(tab);
      galleryEl.innerHTML = '';
      paths.forEach((src, i) => {
        const img = document.createElement('img');
        img.src = src;
        img.alt = src;
        img.loading = 'lazy';
        img.decoding = 'async';
        img.onclick = () => { idx = i; openStd(); };
        galleryEl.appendChild(img);
      });
      // Close friends lightbox if open
      closeFriends();
    }

    // Lightbox standard
    function openStd() {
      stdImg.src = paths[idx];
      stdBox.style.display = 'flex';
    }
    function closeStd() {
      stdBox.style.display = 'none';
      idx = -1;
    }
    function nextStd(d) {
      idx = (idx + d + paths.length) % paths.length;
      openStd();
    }
    stdBox.addEventListener('click', e => { if (e.target === stdBox) closeStd(); });
    document.addEventListener('keydown', e => {
      if (idx === -1) return;
      if (e.key === 'Escape') closeStd();
      if (e.key === 'ArrowRight') nextStd(1);
      if (e.key === 'ArrowLeft')  nextStd(-1);
    });
    let startX = 0;
    stdBox.addEventListener('touchstart', e => { if (e.touches.length === 1) startX = e.touches[0].clientX; }, {passive:true});
    stdBox.addEventListener('touchend',   e => {
      if (idx === -1 || !startX) return;
      const dx = e.changedTouches[0].clientX - startX;
      if (dx > 40) nextStd(-1);
      if (dx < -40) nextStd(1);
      startX = 0;
    });

    // Lightbox friends
    let friendsIndex = -1;
    function openFriends(i) {
      friendsIndex = i;
      friendsImg.src = FRIENDS[i].src;
      friendsCap.textContent = FRIENDS[i].caption;
      friendsBox.classList.add('active');
    }
    function closeFriends() {
      friendsBox.classList.remove('active');
      friendsIndex = -1;
    }
    friendsBox.addEventListener('click', e => { if (e.target === friendsBox) closeFriends(); });
    friendsClose.addEventListener('click', closeFriends);
    document.addEventListener('keydown', e => {
      if (friendsIndex === -1) return;
      if (e.key === 'Escape') closeFriends();
      if (e.key === 'ArrowLeft')  { friendsIndex = (friendsIndex - 1 + FRIENDS.length) % FRIENDS.length; openFriends(friendsIndex); }
      if (e.key === 'ArrowRight') { friendsIndex = (friendsIndex + 1) % FRIENDS.length; openFriends(friendsIndex); }
    });

    // Tab click behavior
    function setActive(tab) {
      underlineActive(tab);
      switch (tab) {
        case 'girl': return renderGirl();
        case 'postcards': return renderPostcards();
        case 'friends': return renderFriends();
        case 'reconstruction': return renderReconstruction();
      }
    }
    tabLinks.forEach(a => {
      a.addEventListener('click', e => {
        e.preventDefault();
        const tab = a.dataset.tab;
        history.replaceState(null, '', '#' + tab);
        setActive(tab);
      });
    });
    window.addEventListener('hashchange', () => setActive(currentTab()));

    // Init
    setActive(currentTab());
  </script>
</body>
</html>
